# 物理アドレスと仮想アドレス

<img width="1527" alt="スクリーンショット 2023-06-10 10 46 29" src="https://github.com/junyaU/os_study_memo/assets/61627945/71cefe09-3b25-42eb-b803-d7e2a03692c7">


## 物理アドレス
コンピューターシステムにおいて、実際のメインメモリ（RAM）の番地を指定するために使われるアドレスのことを物理アドレスと呼ぶ。
ハードウェアやOSから使用され、プログラムからは直接参照することはできない。
プログラムから参照することができるのは、仮想アドレスのみである。

CPUが特定のメモリ位置からデータを読み出したり、書き込んだりする時は、物理アドレスを指定する必要がある。

画像をみると、物理アドレスの0x00300000 ~ 0x00600000にプログラムAが配置されていて、\
物理アドレスの0x00600000 ~ 0x00900000にプログラムBが配置されていることがわかる。

## 仮想アドレス
プログラムから参照されるアドレスのことを仮想アドレスと呼ぶ。 リニアアドレスとも呼ばれる。\
プログラムで、メモリアクセスに使われるポインタの値は全て仮想アドレス。\
仮想アドレスは、物理アドレスに変換されてからメモリにアクセスされる。

仮想アドレス空間は、各プロセスに対して独立して割り当てられ、プロセスが直接アクセスできるメモリ範囲を制限することができる。

仮想アドレスから物理アドレスの変換は、CPU内部のメモリ管理ユニット（MMU）によって行われる。

画像をみると仮想アドレスの0x00100000に配置されているプログラムAが、物理アドレスの0x00300000に配置されていることがわかる。　\
一方、プログラムBの仮想アドレスも0x00100000であるが、物理アドレスは0x00600000に配置されていることがわかる。

このように、それぞれの仮想アドレス空間で同じアドレスを使っても、物理アドレスは異なるものに変換される。\
そのため、プログラムAからプログラムBのメモリにアクセスができず、それぞれが干渉することがない。


### 利点
- **プログラムが物理アドレスを意識する必要がなくなる**
- **プロセス間のメモリの干渉を防ぐことができる**
- **物理メモリよりも大きなメモリ空間を持つことができる**

仮想アドレスが無く、プログラムが物理アドレスを直接参照する場合、プログラム側が物理アドレスの空きを意識しなければならない。\
動くプログラムが決まっている組み込みシステムなどでは、物理アドレスを直接参照しても問題ないが、\
汎用的なOSでは、さまざまなプログラムが動作するため、プログラムが物理アドレスを意識すると、\
新たなプログラムを動かすごとに、物理アドレスの空きを意識しなければならなくなる。

仮想アドレスがあれば、異なるプログラムでも、同じ仮想アドレスを使うことができる。




